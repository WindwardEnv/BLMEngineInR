# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Calculate Species Concentrations
#'
#' Use `CppCalcSpecConc` to calculate species concentrations from a known set of
#' free component ion concentrations.
#'
#' This is an internal function that will, for each species `i` in `NSpec`
#' calculate the equilibrium concentration, which in its most basic form would
#' be calculated as \eqn{SpecConc_{i} = K_{i} *
#' \prod_{j=1}^{n}(CompConc^SpecStoich_{i,j})}. Further modifications to these
#' calculations would include temperature correction, ionic strength
#' corrections, and diffuse double layer calculations for organic matter
#' binding. As of 19-Oct-2023, none of these corrections have been implemented.
#'
#' This is the C++ version of this function.
#'
#' @param CompConc A vector of component concentrations for each of `NComp` components.
#' @param K A vector of reaction equilibrium constants for each of `NSpec` reactions.
#' @param SpecStoich A matrix of reaction stoichiometry, with `NSpec` rows and `NComp` columns.
#' @param NComp The number of components in the equilibrium system.
#' @param NSpec The number of species (reactions) in the equilibrium system.
#'
#' @returns A vector of `NSpec` species concentrations.
#'
#' @examples
#' # data(TestDataFreeConc, TestDataK, TestDataStoich)
#' # CppCalcSpecConc(CompConc = TestDataFreeConc[1:2], K = TestDataK[3:4], SpecStoich = TestDataStoich[3:4,])
#'
#' @noRd
CppCalcSpecConc <- function(CompConc, SpecK, SpecStoich, NComp, NSpec) {
    .Call(`_BLMEngineInR_CppCalcSpecConc`, CompConc, SpecK, SpecStoich, NComp, NSpec)
}

#' Calculate Species Concentrations
#'
#' Use `CppCalcLogSpecConc` to calculate species concentrations from a known set of
#' free component ion concentrations.
#'
#' This is an internal function that will, for each species `i` in `NSpec`
#' calculate the equilibrium concentration, which in its most basic form would
#' be calculated as \eqn{SpecConc_{i} = K_{i} *
#' \prod_{j=1}^{n}(CompConc^SpecStoich_{i,j})}. Further modifications to these
#' calculations would include temperature correction, ionic strength
#' corrections, and diffuse double layer calculations for organic matter
#' binding. As of 19-Oct-2023, none of these corrections have been implemented.
#'
#' This is the C++ version of this function.
#'
#' @param LogCompConc A vector of log10-transformed component concentrations for each of `NComp` components.
#' @param LogK A vector of log10-transformed reaction equilibrium constants for each of `NSpec` reactions.
#' @param SpecStoich A matrix of reaction stoichiometry, with `NSpec` rows and `NComp` columns.
#' @param NComp The number of components in the equilibrium system.
#' @param NSpec The number of species (reactions) in the equilibrium system.
#'
#' @returns A vector of `NSpec` log10-transformed species concentrations.
#'
#' @examples
#' # data(TestDataFreeConc, TestDataK, TestDataStoich)
#' # Log_TestDataFreeConc = log10(TestDataFreeConc)
#' # Log_TestDataK = log10(TestDataK)
#' # 10^CppCalcLogSpecConc(LogCompConc = Log_TestDataFreeConc[1:2],
#' #                       LogK = Log_TestDataK[3:4],
#' #                       SpecStoich = TestDataStoich[3:4,])
#'
#' @noRd
CppCalcLogSpecConc <- function(LogCompConc, SpecLogK, SpecStoich, NComp, NSpec) {
    .Call(`_BLMEngineInR_CppCalcLogSpecConc`, LogCompConc, SpecLogK, SpecStoich, NComp, NSpec)
}

#' @title Calculate the Jacobian matrix
#' @description Calculate the Jacobian matrix of the speciation problem
#'
#' @details This function calculates the Jacobian matrix of the speciation
#'   problem. The Jacobian matrix is an (`NComp` x `NComp`) matrix of
#'   derivatives, where each row gives the derivative of the residual each total
#'   component concentration, dR[i], with respect to, in each column, the
#'   component free concentration, dX[j]. (i.e., \eqn{Z_{i,j} = \delta Resid_{i}
#'   / \delta CompConc_{j}}).
#'
#' @param NComp integer, the number of components
#' @param NSpec integer, the number of species
#' @param SpecStoich integer matrix (NSpec x NComp), the stoichiometry of
#'   each reaction
#' @param SpecConc numeric vector (NSpec), the concentrations of each species
#' @param SpecCtoM numeric vector (NSpec), the factor to apply to
#'   concentrations (i.e., units of mol/L or mol/kg) to convert to masses (i.e.,
#'   units of mol).
#' @param SpecName character vector (NSpec), the species names
#' @param MetalComp integer, the position in component vectors of the toxic
#'   metal component
#' @param BLMetalSpecs integer vector, the position in the species vectors of
#'   the metal-biotic ligand species associated with toxicity
#' @param DoTox logical, if TRUE = toxicity run, FALSE = speciation run
#'
#' @return numeric matrix (NComp x NComp), the jacobian matrix (see details)
#' @keywords internal
NULL

Jacobian <- function(NComp, NSpec, SpecStoich, SpecConc, SpecCtoM, CompName, MetalComp, NBLMetal, BLMetalSpecs, DoTox) {
    .Call(`_BLMEngineInR_Jacobian`, NComp, NSpec, SpecStoich, SpecConc, SpecCtoM, CompName, MetalComp, NBLMetal, BLMetalSpecs, DoTox)
}

