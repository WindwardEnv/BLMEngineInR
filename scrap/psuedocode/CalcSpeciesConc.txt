PROCEDURE CalcSpeciesConc(
  IN:
    NComp : int
    NSpec : int
    Conc(NComp) : Component free ion concentrations (e.g., [H^+], [CO3^-2] of solved problem)
    K(NSpec) : equilibrium coefficient
    Stoich(NComp, NSpec)    
  OUT:
    SConc(NSpec) : Species concentrations (e.g., [HCO3^-], [H2CO3])
  )

  FOR iSpec IN 1 TO NSpec DO
    
    REM X = Conc[:] ^ Stoich[:, iSpec]
    REM Tmp = PROD(X) * K[iSpec]
    REM ...where PROD(X) = X[1] * X[2] * ... * X[n]
    
    Tmp = 0
    FOR iComp IN 1 TO NComp DO
      Tmp = Tmp * Conc[iComp] ^ Stoich[iComp, iSpec]
    END FOR
    SConc[iSpec] = Tmp * K[iSpec]
    
  END FOR
  
  RETURN SConc
  
END